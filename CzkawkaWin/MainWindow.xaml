<Window x:Class="CzkawkaWin.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CzkawkaWin"
        mc:Ignorable="d"
        Title="CzkawkaWin - Duplicate File Finder" Height="650" Width="1100" ThemeMode="Dark"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Empty State Style -->
        <Style x:Key="EmptyStateText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#666"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="TextAlignment" Value="Center"/>
        </Style>
        <Style x:Key="EmptyStateIcon" TargetType="TextBlock">
            <Setter Property="FontSize" Value="48"/>
            <Setter Property="Foreground" Value="#444"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <Style x:Key="PanelHeader" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#999"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top Toolbar -->
        <Border Grid.Row="0" Padding="12,10" Background="#1e1e1e" BorderThickness="0,0,0,1" BorderBrush="#333">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Image Source="magnifier.png" Width="20" Height="20" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBlock Text="CzkawkaWin" FontSize="16" FontWeight="Bold" VerticalAlignment="Center" Foreground="#2196F3"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="📂 Load JSON Report" Click="BtnLoadJson_Click" Padding="20,8" FontSize="13"/>
                </StackPanel>
                
                <TextBlock x:Name="TxtStatus" Grid.Column="2" Text="Ready" VerticalAlignment="Center" 
                           Foreground="#888" FontSize="12"/>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280" MinWidth="200"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="1.5*" MinWidth="250"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="2*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- Groups List (Left Panel) -->
            <Grid Grid.Column="0" Background="#252525">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Panel Header -->
                <Border Grid.Row="0" Padding="12,10" Background="#2a2a2a" BorderThickness="0,0,0,1" BorderBrush="#333">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📁" Margin="0,0,8,0"/>
                        <TextBlock Text="DUPLICATE GROUPS" Style="{StaticResource PanelHeader}"/>
                        <TextBlock x:Name="TxtGroupCount" Text="" Foreground="#666" Margin="8,0,0,0" FontSize="11"/>
                    </StackPanel>
                </Border>
                
                <!-- Empty State for Groups -->
                <StackPanel x:Name="EmptyGroupsState" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="20">
                    <TextBlock Text="📋" Style="{StaticResource EmptyStateIcon}"/>
                    <TextBlock Text="No data loaded" Style="{StaticResource EmptyStateText}" FontWeight="SemiBold" FontSize="14"/>
                    <TextBlock Text="Click 'Load JSON Report' to&#x0a;import a Czkawka scan result" 
                               Style="{StaticResource EmptyStateText}" Margin="0,8,0,0" LineHeight="20"/>
                </StackPanel>
                
                <ListView Grid.Row="1" Name="GroupsList" 
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.ScrollUnit="Pixel"
                          SelectionChanged="GroupsList_SelectionChanged"
                          Background="Transparent"
                          BorderThickness="0">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="8,6" Margin="4,2" Background="#333" CornerRadius="4">
                                <StackPanel>
                                    <TextBlock FontWeight="SemiBold" Foreground="#2196F3" FontSize="13">
                                        <Run Text="{Binding HumanSize, Mode=OneWay}"/>
                                        <Run Text=" • " Foreground="#555"/>
                                        <Run Text="{Binding Count, Mode=OneWay}" Foreground="#888"/>
                                        <Run Text=" files" Foreground="#888"/>
                                    </TextBlock>
                                    <TextBlock Text="{Binding FileNames}" 
                                               Foreground="#666" 
                                               FontSize="10"
                                               Margin="0,4,0,0"
                                               MaxHeight="40"
                                               TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="#1a1a1a"/>

            <!-- Files List (Center Panel) -->
            <Grid Grid.Column="2" Background="#252525">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Panel Header -->
                <Border Grid.Row="0" Padding="12,10" Background="#2a2a2a" BorderThickness="0,0,0,1" BorderBrush="#333">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📄" Margin="0,0,8,0"/>
                        <TextBlock Text="FILES IN GROUP" Style="{StaticResource PanelHeader}"/>
                    </StackPanel>
                </Border>
                
                <!-- Empty State for Files -->
                <StackPanel x:Name="EmptyFilesState" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="20">
                    <TextBlock Text="👈" Style="{StaticResource EmptyStateIcon}"/>
                    <TextBlock Text="Select a group" Style="{StaticResource EmptyStateText}" FontWeight="SemiBold" FontSize="14"/>
                    <TextBlock Text="Choose a duplicate group from&#x0a;the left panel to see files" 
                               Style="{StaticResource EmptyStateText}" Margin="0,8,0,0" LineHeight="20"/>
                </StackPanel>
                
                <ListView Grid.Row="1" Name="FilesList" 
                          ItemsSource="{Binding ElementName=GroupsList, Path=SelectedItem.Items}"
                          SelectionChanged="FilesList_SelectionChanged"
                          MouseDoubleClick="FilesList_MouseDoubleClick"
                          Background="Transparent"
                          BorderThickness="0">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="8,6" Margin="4,2" Background="#333" CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Thumbnail -->
                                    <Border Grid.Column="0" 
                                            Width="42" Height="42" 
                                            Background="#444" 
                                            CornerRadius="4"
                                            Margin="0,0,10,0">
                                        <Image Source="{Binding Thumbnail}" 
                                               Stretch="UniformToFill"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                    </Border>
                                    
                                    <!-- File Info -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding FileName}" 
                                                   FontWeight="SemiBold"
                                                   FontSize="12"
                                                   TextTrimming="CharacterEllipsis"
                                                   ToolTip="{Binding Path}"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                            <TextBlock Text="{Binding HumanSize}" 
                                                       Foreground="#888" 
                                                       FontSize="11"/>
                                            <TextBlock Text=" • " Foreground="#555" FontSize="11"/>
                                            <TextBlock Text="{Binding HumanDate, StringFormat='MM/dd/yy HH:mm'}" 
                                                       Foreground="#666" 
                                                       FontSize="11"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>

            <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Background="#1a1a1a"/>

            <!-- Preview Panel (Right) -->
            <Grid Grid.Column="4" x:Name="PreviewPanel" Background="#1e1e1e">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Border Grid.Row="0" Padding="12,10" Background="#2a2a2a" BorderThickness="0,0,0,1" BorderBrush="#333">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="👁️" Margin="0,0,8,0"/>
                        <TextBlock Text="FILE PREVIEW" Style="{StaticResource PanelHeader}"/>
                    </StackPanel>
                </Border>

                <!-- File Info Panel -->
                <Border Grid.Row="1" Padding="12" Background="#252525" x:Name="FileInfoPanel" Visibility="Collapsed" 
                        BorderThickness="0,0,0,1" BorderBrush="#333">
                    <StackPanel>
                        <TextBlock x:Name="TxtFilePath" TextWrapping="Wrap" FontWeight="SemiBold" Foreground="#2196F3" FontSize="12"/>
                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Size: " Foreground="#666" FontSize="11"/>
                            <TextBlock x:Name="TxtFileSize" Grid.Row="0" Grid.Column="1" FontSize="11"/>
                            
                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Date: " Foreground="#666" Margin="20,0,0,0" FontSize="11"/>
                            <TextBlock x:Name="TxtFileDate" Grid.Row="0" Grid.Column="3" FontSize="11"/>
                            
                            <TextBlock x:Name="TxtVideoInfo" 
                                       Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4"
                                       Visibility="Collapsed"
                                       Foreground="#4CAF50"
                                       FontSize="11"
                                       Margin="0,6,0,0"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Preview Area -->
                <Grid Grid.Row="2">
                    <!-- Empty State for Preview -->
                    <StackPanel x:Name="EmptyPreviewState" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="20">
                        <TextBlock Text="🖼️" Style="{StaticResource EmptyStateIcon}" FontSize="64"/>
                        <TextBlock Text="Preview Area" Style="{StaticResource EmptyStateText}" FontWeight="SemiBold" FontSize="16"/>
                        <TextBlock Text="Select a file from the center panel&#x0a;to preview images and videos" 
                                   Style="{StaticResource EmptyStateText}" Margin="0,10,0,0" LineHeight="22"/>
                        <Border Margin="0,20,0,0" Padding="15,10" Background="#333" CornerRadius="6">
                            <TextBlock Text="💡 Double-click a file to open its folder" Foreground="#888" FontSize="11"/>
                        </Border>
                    </StackPanel>

                    <!-- No Preview Message -->
                    <TextBlock x:Name="TxtNoPreview" 
                               Text="" 
                               Foreground="#888" 
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Visibility="Collapsed"
                               FontSize="13"/>

                    <!-- Image Preview -->
                    <Image x:Name="ImagePreview" 
                           Stretch="Uniform" 
                           Visibility="Collapsed"
                           Margin="15"/>

                    <!-- Video Preview -->
                    <MediaElement x:Name="VideoPreview" 
                                  LoadedBehavior="Manual"
                                  UnloadedBehavior="Manual"
                                  Visibility="Collapsed"
                                  Stretch="Uniform"
                                  Margin="15"
                                  MediaOpened="VideoPreview_MediaOpened"
                                  MediaEnded="VideoPreview_MediaEnded"/>
                </Grid>

                <!-- Video Controls -->
                <Border Grid.Row="3" 
                        x:Name="VideoControls" 
                        Visibility="Collapsed" 
                        Padding="12" 
                        Background="#2a2a2a"
                        BorderThickness="0,1,0,0"
                        BorderBrush="#333">
                    <StackPanel>
                        <Slider x:Name="VideoSeekBar" 
                                Minimum="0" 
                                Maximum="100" 
                                Value="0"
                                Margin="0,0,0,12"
                                PreviewMouseLeftButtonUp="VideoSeekBar_PreviewMouseLeftButtonUp"
                                PreviewMouseLeftButtonDown="VideoSeekBar_PreviewMouseLeftButtonDown"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="▶️ Play" Click="BtnPlay_Click" Padding="15,8" Margin="4"/>
                            <Button Content="⏸️ Pause" Click="BtnPause_Click" Padding="15,8" Margin="4"/>
                            <Button Content="⏹️ Stop" Click="BtnStop_Click" Padding="15,8" Margin="4"/>
                            <TextBlock x:Name="TxtVideoTime" 
                                       Text="00:00 / 00:00" 
                                       VerticalAlignment="Center" 
                                       Margin="15,0,0,0"
                                       Foreground="#888"
                                       FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>

        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Padding="12,8" Background="#1a1a1a" BorderThickness="0,1,0,0" BorderBrush="#333">
            <Grid>
                <TextBlock x:Name="TxtStatusBar" Text="Welcome! Load a Czkawka JSON report to find and manage duplicate files." 
                           Foreground="#666" FontSize="11"/>
                <TextBlock HorizontalAlignment="Right" Foreground="#555" FontSize="11">
                    <Run Text="CzkawkaWin v"/><Run Text="{Binding AppVersion, Mode=OneTime}"/>
                </TextBlock>
            </Grid>
        </Border>
    </Grid>
</Window>